from collections import OrderedDict
from sqlalchemy import func, cast, Date

from dataactcore.models.stagingModels import DetachedAwardProcurement

file_model = DetachedAwardProcurement

mapping = OrderedDict([
    ('detached_award_proc_unique', ['ContractTransactionUniqueKey', 'ContractTransactionUniqueKey ()']),
    ('unique_award_key', ['PrimeAwardUniqueKey', 'PrimeAwardUniqueKey ()']),
    ('piid', ['PIID', 'PIID (1A)']),
    ('award_modification_amendme', ['AwardModificationAmendmentNumber', 'AwardModificationAmendmentNumber (1B)']),
    ('transaction_number', ['TransactionNumber', 'TransactionNumber (1D)']),
    ('referenced_idv_agency_iden', ['Referenced_IDV_Agency_Identifier', 'Referenced_IDV_Agency_Identifier (1H)']),
    ('referenced_idv_agency_desc', ['Referenced IDV Agency Name', 'Referenced IDV Agency Name ()']),
    ('parent_award_id', ['ParentAwardId', 'ParentAwardId (1C)']),
    ('referenced_idv_modificatio', ['Referenced_IDV_Modification_Number', 'Referenced_IDV_Modification_Number (1G)']),
    ('federal_action_obligation', ['FederalActionObligation', 'FederalActionObligation (3C)']),
    ('total_obligated_amount', ['TotalDollarsObligated', 'TotalDollarsObligated (3CT)']),
    ('base_exercised_options_val', ['BaseAndExercisedOptionsValue', 'BaseAndExercisedOptionsValue (3B)']),
    ('current_total_value_award', ['CurrentTotalValueOfAward', 'CurrentTotalValueOfAward (3BT)']),
    ('base_and_all_options_value', ['BaseAndAllOptionsValue', 'BaseAndAllOptionsValue (3A)']),
    ('potential_total_value_awar', ['PotentialTotalValueOfAward', 'PotentialTotalValueOfAward (3AT)']),
    ('action_date', ['ActionDate', 'ActionDate (2A)']),
    ('period_of_performance_star', ['PeriodOfPerformanceStartDate', 'PeriodOfPerformanceStartDate (2B)']),
    ('period_of_performance_curr', ['PeriodOfPerformanceCurrentEndDate', 'PeriodOfPerformanceCurrentEndDate (2C)']),
    ('period_of_perf_potential_e', ['PeriodOfPerformancePotentialEndDate', 'PeriodOfPerformancePotentialEndDate (2D)']),
    ('ordering_period_end_date', ['OrderingPeriodEndDate', 'OrderingPeriodEndDate (2E)']),
    ('solicitation_date', ['SolicitationDate', 'SolicitationDate (2H)']),
    ('awarding_agency_code', ['AwardingAgencyCode', 'AwardingAgencyCode ()']),
    ('awarding_agency_name', ['AwardingAgencyName', 'AwardingAgencyName ()']),
    ('awarding_sub_tier_agency_c', ['AwardingSubTierAgencyCode', 'AwardingSubTierAgencyCode (4A)']),
    ('awarding_sub_tier_agency_n', ['AwardingSubTierAgencyName', 'AwardingSubTierAgencyName ()']),
    ('awarding_office_code', ['AwardingOfficeCode', 'AwardingOfficeCode (4B)']),
    ('awarding_office_name', ['AwardingOfficeName', 'AwardingOfficeName ()']),
    ('funding_agency_code', ['FundingAgencyCode', 'FundingAgencyCode ()']),
    ('funding_agency_name', ['FundingAgencyName', 'FundingAgencyName ()']),
    ('funding_sub_tier_agency_co', ['FundingSubTierAgencyCode', 'FundingSubTierAgencyCode (4C)']),
    ('funding_sub_tier_agency_na', ['FundingSubTierAgencyName', 'FundingSubTierAgencyName ()']),
    ('funding_office_code', ['FundingOfficeCode', 'FundingOfficeCode (4D)']),
    ('funding_office_name', ['FundingOfficeName', 'FundingOfficeName ()']),
    ('foreign_funding', ['ForeignFunding', 'ForeignFunding (4F)']),
    ('foreign_funding_desc', ['Foreign Funding Description Tag', 'Foreign Funding Description Tag ()']),
    ('sam_exception', ['SAMException', 'SAMException (9J)']),
    ('sam_exception_description', ['SAM Exception Description Tag', 'SAM Exception Description Tag ()']),
    ('awardee_or_recipient_uei', ['AwardeeOrRecipientUEI', 'AwardeeOrRecipientUEI (9M)']),
    ('awardee_or_recipient_legal', ['AwardeeOrRecipientLegalEntityName', 'AwardeeOrRecipientLegalEntityName (13GG)']),
    ('vendor_doing_as_business_n', ['EntityDoingBusinessAsName', 'EntityDoingBusinessAsName (13HH)']),
    ('cage_code', ['CAGECode', 'CAGECode (9L)']),
    ('ultimate_parent_uei', ['UltimateParentUEI', 'UltimateParentUEI ()']),
    ('ultimate_parent_legal_enti', ['UltimateParentLegalEntityName', 'UltimateParentLegalEntityName ()']),
    ('legal_entity_country_code', ['LegalEntityCountryCode', 'LegalEntityCountryCode (13QQ)']),
    ('legal_entity_country_name', ['LegalEntityCountryName', 'LegalEntityCountryName ()']),
    ('legal_entity_address_line1', ['LegalEntityAddressLine1', 'LegalEntityAddressLine1 (13JJ)']),
    ('legal_entity_address_line2', ['LegalEntityAddressLine2', 'LegalEntityAddressLine2 (13KK)']),
    ('legal_entity_city_name', ['LegalEntityCityName', 'LegalEntityCityName (13MM)']),
    ('legal_entity_state_code', ['LegalEntityStateCode', 'LegalEntityStateCode (13NN)']),
    ('legal_entity_state_descrip', ['LegalEntityStateDescription', 'LegalEntityStateDescription (13NN)']),
    ('legal_entity_zip4', ['LegalEntityZIP+4', 'LegalEntityZIP+4 (13PP)']),
    ('legal_entity_congressional', ['LegalEntityCongressionalDistrict', 'LegalEntityCongressionalDistrict (9F)']),
    ('vendor_phone_number', ['EntityPhoneNumber', 'EntityPhoneNumber (13RR)']),
    ('vendor_fax_number', ['EntityFaxNumber', 'EntityFaxNumber (13SS)']),
    ('place_of_perform_city_name', ['PrimaryPlaceOfPerformanceCityName', 'PrimaryPlaceOfPerformanceCityName (9D)']),
    ('place_of_perform_county_na', ['PrimaryPlaceOfPerformanceCountyName', 'PrimaryPlaceOfPerformanceCountyName ()']),
    ('place_of_performance_state', ['PrimaryPlaceOfPerformanceStateCode', 'PrimaryPlaceOfPerformanceStateCode (9C)']),
    ('place_of_perfor_state_desc', ['PrimaryPlaceOfPerformanceStateName', 'PrimaryPlaceOfPerformanceStateName ()']),
    ('place_of_performance_zip4a', ['PrimaryPlaceOfPerformanceZIP+4', 'PrimaryPlaceOfPerformanceZIP+4 (9K)']),
    ('place_of_performance_congr', ['PrimaryPlaceOfPerformanceCongressionalDistrict',
                                    'PrimaryPlaceOfPerformanceCongressionalDistrict (9G)']),
    ('place_of_perform_country_c', ['PrimaryPlaceOfPerformanceCountryCode',
                                    'PrimaryPlaceOfPerformanceCountryCode (9C)']),
    ('place_of_perf_country_desc', ['PrimaryPlaceOfPerformanceCountryName', 'PrimaryPlaceOfPerformanceCountryName ()']),
    ('pulled_from', ['Award Or IDV Flag', 'Award Or IDV Flag ()']),
    ('contract_award_type', ['ContractAwardType', 'ContractAwardType (12B)']),
    ('contract_award_type_desc', ['ContractAwardTypeDescriptionTag', 'ContractAwardTypeDescriptionTag ()']),
    ('idv_type', ['IDV_Type', 'IDV_Type (12A)']),
    ('idv_type_description', ['IDV_Type Description Tag', 'IDV_Type Description Tag ()']),
    ('multiple_or_single_award_i', ['MultipleOrSingleAwardIDV', 'MultipleOrSingleAwardIDV (6E)']),
    ('multiple_or_single_aw_desc', ['Multiple or Single Award IDV Description Tag',
                                    'Multiple or Single Award IDV Description Tag ()']),
    ('type_of_idc', ['Type_of_IDC', 'Type_of_IDC (6D)']),
    ('type_of_idc_description', ['Type of IDC Description Tag', 'Type of IDC Description Tag ()']),
    ('type_of_contract_pricing', ['TypeOfContractPricing', 'TypeOfContractPricing (6A)']),
    ('type_of_contract_pric_desc', ['TypeOfContractPricingDescriptionTag', 'TypeOfContractPricingDescriptionTag ()']),
    ('award_description', ['AwardDescription', 'AwardDescription (6M)']),
    ('action_type', ['ActionType', 'ActionType (12C)']),
    ('action_type_description', ['ActionTypeDescriptionTag', 'ActionTypeDescriptionTag ()']),
    ('solicitation_identifier', ['SolicitationIdentifier', 'SolicitationIdentifier (1E)']),
    ('number_of_actions', ['Number_of_Actions', 'Number_of_Actions (6Q)']),
    ('inherently_government_func', ['InherentlyGovernmentalFunctions', 'InherentlyGovernmentalFunctions (6T)']),
    ('inherently_government_desc', ['Inherently Governmental Functions Description Tag',
                                    'Inherently Governmental Functions Description Tag ()']),
    ('product_or_service_code', ['Product_or_Service_Code', 'Product_or_Service_Code (8A)']),
    ('product_or_service_co_desc', ['Product or Service Code Description Tag',
                                    'Product or Service Code Description Tag ()']),
    ('contract_bundling', ['ContractBundling', 'ContractBundling (8N)']),
    ('contract_bundling_descrip', ['Contract Bundling Description Tag', 'Contract Bundling Description Tag ()']),
    ('dod_claimant_program_code', ['DoD_Claimant_Program_Code', 'DoD_Claimant_Program_Code (8F)']),
    ('dod_claimant_prog_cod_desc', ['DoD Claimant Program Code Description Tag',
                                    'DoD Claimant Program Code Description Tag ()']),
    ('naics', ['NAICS', 'NAICS (8G)']),
    ('naics_description', ['NAICS_Description', 'NAICS_Description ()']),
    ('recovered_materials_sustai', ['RecoveredMaterials/Sustainability', 'RecoveredMaterials/Sustainability (8L)']),
    ('recovered_materials_s_desc', ['Recovered Materials/Sustainability Description Tag',
                                    'Recovered Materials/Sustainability Description Tag ()']),
    ('domestic_or_foreign_entity', ['Domestic_or_Foreign_Entity', 'Domestic_or_Foreign_Entity (8Q)']),
    ('domestic_or_foreign_e_desc', ['Domestic or Foreign Entity Description Tag',
                                    'Domestic or Foreign Entity Description Tag ()']),
    ('program_system_or_equipmen', ['DOD_Acquisition_Program', 'DOD_Acquisition_Program (8B)']),
    ('program_system_or_equ_desc', ['DOD Acquisition Program Description Tag',
                                    'DOD Acquisition Program Description Tag ()']),
    ('information_technology_com', ['InformationTechnologyCommercialItemCategory',
                                    'InformationTechnologyCommercialItemCategory (8H)']),
    ('information_technolog_desc', ['Information Technology Commercial Item Category Description Tag',
                                    'Information Technology Commercial Item Category Description Tag ()']),
    ('epa_designated_product', ['EPA-DesignatedProduct', 'EPA-DesignatedProduct (8K)']),
    ('epa_designated_produc_desc', ['EPA-Designated Product Description Tag',
                                    'EPA-Designated Product Description Tag ()']),
    ('country_of_product_or_serv', ['CountryOfProductOrServiceOrigin',
                                    'CountryOfProductOrServiceOrigin (9E)']),
    ('country_of_product_or_desc', ['Country of Product or Service Origin Description Tag',
                                    'Country of Product or Service Origin Description Tag ()']),
    ('place_of_manufacture', ['PlaceOfManufacture', 'PlaceOfManufacture (9H)']),
    ('place_of_manufacture_desc', ['Place of Manufacture Description Tag',
                                   'Place of Manufacture Description Tag ()']),
    ('subcontracting_plan', ['SubcontractingPlan', 'SubcontractingPlan (11B)']),
    ('subcontracting_plan_desc', ['Subcontracting Plan Description Tag', 'Subcontracting Plan Description Tag ()']),
    ('extent_competed', ['ExtentCompeted', 'ExtentCompeted (10A)']),
    ('extent_compete_description', ['Extent Competed Description Tag', 'Extent Competed Description Tag ()']),
    ('solicitation_procedures', ['SolicitationProcedures', 'SolicitationProcedures (10M)']),
    ('solicitation_procedur_desc', ['Solicitation Procedures Description Tag',
                                    'Solicitation Procedures Description Tag ()']),
    ('type_set_aside', ['TypeSetAside', 'TypeSetAside (10N)']),
    ('type_set_aside_description', ['Type Set Aside Description Tag', 'Type Set Aside Description Tag ()']),
    ('evaluated_preference', ['EvaluatedPreference', 'EvaluatedPreference (10P)']),
    ('evaluated_preference_desc', ['Evaluated Preference Description Tag',
                                   'Evaluated Preference Description Tag ()']),
    ('research', ['Research', 'Research (10Q)']),
    ('research_description', ['Research Description Tag', 'Research Description Tag ()']),
    ('fair_opportunity_limited_s', ['FairOpportunityLimitedSources', 'FairOpportunityLimitedSources (10R)']),
    ('fair_opportunity_limi_desc', ['Fair Opportunity Limited Sources Description Tag',
                                    'Fair Opportunity Limited Sources Description Tag ()']),
    ('other_than_full_and_open_c', ['OtherThanFullAndOpenCompetition',
                                    'OtherThanFullAndOpenCompetition (10C)']),
    ('other_than_full_and_o_desc', ['Other than Full and Open Competition Description Tag',
                                    'Other than Full and Open Competition Description Tag ()']),
    ('number_of_offers_received', ['NumberOfOffersReceived', 'NumberOfOffersReceived (10D)']),
    ('commercial_item_acquisitio', ['CommercialItemAcquisitionProcedures',
                                    'CommercialItemAcquisitionProcedures (10H)']),
    ('commercial_item_acqui_desc', ['Commercial Item Acquisition Procedures Description Tag',
                                    'Commercial Item Acquisition Procedures Description Tag ()']),
    ('small_business_competitive', ['SmallBusinessCompetitivenessDemonstrationProgram',
                                    'SmallBusinessCompetitivenessDemonstrationProgram (10K)']),
    ('commercial_item_test_progr', ['SimplifiedProceduresForCertainCommercialItems',
                                    'SimplifiedProceduresForCertainCommercialItems (10J)']),
    ('commercial_item_test_desc', ['Commercial Item Test Program Description Tag',
                                   'Commercial Item Test Program Description Tag ()']),
    ('a_76_fair_act_action', ['A-76FAIRActAction', 'A-76FAIRActAction (10L)']),
    ('a_76_fair_act_action_desc', ['A-76 FAIR Act Action Description Tag',
                                   'A-76 FAIR Act Action Description Tag ()']),
    ('fed_biz_opps', ['ContractOpportunitiesNotice', 'ContractOpportunitiesNotice (10S)']),
    ('fed_biz_opps_description', ['Contract Opportunities Notice Description Tag',
                                  'Contract Opportunities Notice Description Tag ()']),
    ('local_area_set_aside', ['LocalAreaSetAside', 'LocalAreaSetAside (10U)']),
    ('local_area_set_aside_desc', ['Local Area Set Aside Description Tag',
                                   'Local Area Set Aside Description Tag ()']),
    ('price_evaluation_adjustmen', ['PriceEvaluationAdjustmentPreferencePercentDifference',
                                    'PriceEvaluationAdjustmentPreferencePercentDifference (11C)']),
    ('clinger_cohen_act_planning', ['Clinger-CohenActPlanningCompliance', 'Clinger-CohenActPlanningCompliance (7A)']),
    ('clinger_cohen_act_pla_desc', ['Clinger-Cohen Act Planning Compliance Description Tag',
                                    'Clinger-Cohen Act Planning Compliance Description Tag ()']),
    ('materials_supplies_article', ['MaterialsSuppliesArticlesAndEquip',
                                    'MaterialsSuppliesArticlesAndEquip (7B)']),
    ('materials_supplies_descrip', ['Materials, Supplies, Articles & Equip Description Tag',
                                    'Materials, Supplies, Articles & Equip Description Tag ()']),
    ('labor_standards', ['LaborStandards', 'LaborStandards (7C)']),
    ('labor_standards_descrip', ['Labor Standards Description Tag', 'Labor Standards Description Tag ()']),
    ('construction_wage_rate_req', ['ConstructionWageRateRequirements', 'ConstructionWageRateRequirements (7D)']),
    ('construction_wage_rat_desc', ['Construction Wage Rate Requirements Description Tag',
                                    'Construction Wage Rate Requirements Description Tag ()']),
    ('interagency_contracting_au', ['InteragencyContractingAuthority', 'InteragencyContractingAuthority (7E)']),
    ('interagency_contract_desc', ['Interagency Contracting Authority Description Tag',
                                   'Interagency Contracting Authority Description Tag ()']),
    ('other_statutory_authority', ['OtherStatutoryAuthority', 'OtherStatutoryAuthority (7F)']),
    ('additional_reporting', ['AdditionalReporting', 'AdditionalReporting (7G)']),
    ('program_acronym', ['ProgramAcronym', 'ProgramAcronym (6P)']),
    ('referenced_idv_type', ['Referenced IDV Type', 'Referenced IDV Type ()']),
    ('referenced_idv_type_desc', ['Referenced IDV Type Description Tag', 'Referenced IDV Type Description Tag ()']),
    ('referenced_mult_or_single', ['Referenced IDV Multiple or Single', 'Referenced IDV Multiple or Single ()']),
    ('referenced_mult_or_si_desc', ['Referenced IDV Multiple or Single Description Tag',
                                    'Referenced IDV Multiple or Single Description Tag ()']),
    ('major_program', ['MajorProgram', 'MajorProgram (6G)']),
    ('national_interest_action', ['NationalInterestAction', 'NationalInterestAction (6R)']),
    ('national_interest_desc', ['National Interest Action Description Tag',
                                'National Interest Action Description Tag ()']),
    ('cost_or_pricing_data', ['CostOrPricingData', 'CostOrPricingData (6J)']),
    ('cost_or_pricing_data_desc', ['Cost or Pricing Data Description Tag',
                                   'Cost or Pricing Data Description Tag ()']),
    ('cost_accounting_standards', ['CostAccountingStandardsClause', 'CostAccountingStandardsClause (6L)']),
    ('cost_accounting_stand_desc', ['Cost Accounting Standards Clause Description Tag',
                                    'Cost Accounting Standards Clause Description Tag ()']),
    ('government_furnished_prope', ['GovernmentFurnishedProperty(GFP)', 'GovernmentFurnishedProperty(GFP) (8J)']),
    ('government_furnished_desc', ['Government Furnished Property GFP Description Tag',
                                   'Government Furnished Property GFP Description Tag ()']),
    ('sea_transportation', ['SeaTransportation', 'SeaTransportation (8M)']),
    ('sea_transportation_desc', ['Sea Transportation Description Tag', 'Sea Transportation Description Tag ()']),
    ('undefinitized_action', ['UndefinitizedAction', 'UndefinitizedAction (6B)']),
    ('undefinitized_action_desc', ['Undefinitized Action Description Tag',
                                   'Undefinitized Action Description Tag ()']),
    ('consolidated_contract', ['ConsolidatedContract', 'ConsolidatedContract (8P)']),
    ('consolidated_contract_desc', ['Consolidated Contract Description Tag',
                                    'Consolidated Contract Description Tag ()']),
    ('performance_based_service', ['Performance-BasedServiceAcquisition',
                                   'Performance-BasedServiceAcquisition (6F)']),
    ('performance_based_se_desc', ['Performance-Based Service Acquisition Description Tag',
                                   'Performance-Based Service Acquisition Description Tag ()']),
    ('multi_year_contract', ['MultiYearContract', 'MultiYearContract (6C)']),
    ('multi_year_contract_desc', ['Multi Year Contract Description Tag', 'Multi Year Contract Description Tag ()']),
    ('contract_financing', ['ContractFinancing', 'ContractFinancing (6K)']),
    ('contract_financing_descrip', ['Contract Financing Description Tag', 'Contract Financing Description Tag ()']),
    ('purchase_card_as_payment_m', ['PurchaseCardAsPaymentMethod', 'PurchaseCardAsPaymentMethod (6N)']),
    ('purchase_card_as_paym_desc', ['Purchase Card as Payment Method Description Tag',
                                    'Purchase Card as Payment Method Description Tag ()']),
    ('contingency_humanitarian_o', ['EmergencyAcquisition', 'EmergencyAcquisition (6H)']),
    ('contingency_humanitar_desc', ['Emergency Acquisition Description Tag',
                                    'Emergency Acquisition Description Tag ()']),
    ('alaskan_native_owned_corpo', ['AlaskanNativeCorporationOwnedFirm', 'AlaskanNativeCorporationOwnedFirm (13YA)']),
    ('american_indian_owned_busi', ['AmericanIndianOwnedBusiness', 'AmericanIndianOwnedBusiness (13Y)']),
    ('indian_tribe_federally_rec', ['IndianTribeFederallyRecognized', 'IndianTribeFederallyRecognized (13YB)']),
    ('native_hawaiian_owned_busi', ['NativeHawaiianOrganizationOwnedFirm',
                                    'NativeHawaiianOrganizationOwnedFirm (13YC)']),
    ('tribally_owned_business', ['TriballyOwnedFirm', 'TriballyOwnedFirm (13YD)']),
    ('veteran_owned_business', ['VeteranOwnedBusiness', 'VeteranOwnedBusiness (13V)']),
    ('service_disabled_veteran_o', ['ServiceDisabledVeteranOwnedBusiness',
                                    'ServiceDisabledVeteranOwnedBusiness (13W)']),
    ('woman_owned_business', ['WomanOwnedBusiness', 'WomanOwnedBusiness (13U)']),
    ('women_owned_small_business', ['WomenOwnedSmallBusiness', 'WomenOwnedSmallBusiness (13UB)']),
    ('economically_disadvantaged', ['EconomicallyDisadvantagedWomenOwnedSmallBusiness',
                                    'EconomicallyDisadvantagedWomenOwnedSmallBusiness (13UC)']),
    ('joint_venture_women_owned', ['JointVentureWomenOwnedSmallBusiness',
                                   'JointVentureWomenOwnedSmallBusiness (13UD)']),
    ('joint_venture_economically', ['JointVentureEconomicallyDisadvantagedWomenOwnedSmallBusiness',
                                    'JointVentureEconomicallyDisadvantagedWomenOwnedSmallBusiness (13UE)']),
    ('minority_owned_business', ['MinorityOwnedBusiness', 'MinorityOwnedBusiness (13UA)']),
    ('subcontinent_asian_asian_i', ['Subcontinent_Asian_Asian-Indian_American_Owned_Business',
                                    'Subcontinent_Asian_Asian-Indian_American_Owned_Business (13DD)']),
    ('asian_pacific_american_own', ['AsianPacificAmericanOwnedBusiness', 'AsianPacificAmericanOwnedBusiness (13Z)']),
    ('black_american_owned_busin', ['BlackAmericanOwnedBusiness', 'BlackAmericanOwnedBusiness (13AA)']),
    ('hispanic_american_owned_bu', ['HispanicAmericanOwnedBusiness', 'HispanicAmericanOwnedBusiness (13BB)']),
    ('native_american_owned_busi', ['NativeAmericanOwnedBusiness', 'NativeAmericanOwnedBusiness (13CC)']),
    ('other_minority_owned_busin', ['OtherMinorityOwnedBusiness', 'OtherMinorityOwnedBusiness (13DE)']),
    ('contracting_officers_deter', ['ContractingOfficer\'sDeterminationOfBusinessSize',
                                    'ContractingOfficer\'sDeterminationOfBusinessSize (11A)']),
    ('contracting_officers_desc', ['Contracting Officer\'s Determination of Business Size Description Tag',
                                   'Contracting Officer\'s Determination of Business Size Description Tag ()']),
    ('emerging_small_business', ['EmergingSmallBusiness', 'EmergingSmallBusiness (13M)']),
    ('community_developed_corpor', ['CommunityDevelopedCorporationOwnedFirm',
                                    'CommunityDevelopedCorporationOwnedFirm (13LB)']),
    ('labor_surplus_area_firm', ['LaborSurplusAreaFirm', 'LaborSurplusAreaFirm (13LC)']),
    ('us_federal_government', ['U.S.FederalGovernment', 'U.S.FederalGovernment (13K)']),
    ('federally_funded_research', ['FederallyFundedResearchAndDevelopmentCorp',
                                   'FederallyFundedResearchAndDevelopmentCorp (13KB)']),
    ('federal_agency', ['FederalAgency', 'FederalAgency (13KA)']),
    ('us_state_government', ['U.S.StateGovernment', 'U.S.StateGovernment (13J)']),
    ('us_local_government', ['U.S.LocalGovernment', 'U.S.LocalGovernment (13I)']),
    ('city_local_government', ['CityLocalGovernment', 'CityLocalGovernment (13IA)']),
    ('county_local_government', ['CountyLocalGovernment', 'CountyLocalGovernment (13IB)']),
    ('inter_municipal_local_gove', ['Inter-MunicipalLocalGovernment', 'Inter-MunicipalLocalGovernment (13IC)']),
    ('local_government_owned', ['LocalGovernmentOwned', 'LocalGovernmentOwned (13ID)']),
    ('municipality_local_governm', ['MunicipalityLocalGovernment', 'MunicipalityLocalGovernment (13IE)']),
    ('school_district_local_gove', ['SchoolDistrictLocalGovernment', 'SchoolDistrictLocalGovernment (13IF)']),
    ('township_local_government', ['TownshipLocalGovernment', 'TownshipLocalGovernment (13IG)']),
    ('us_tribal_government', ['U.S.TribalGovernment', 'U.S.TribalGovernment (13L)']),
    ('foreign_government', ['ForeignGovernment', 'ForeignGovernment (13LA)']),
    ('organizational_type', ['OrganizationalType', 'OrganizationalType ()']),
    ('corporate_entity_not_tax_e', ['CorporateEntityNotTaxExempt', 'CorporateEntityNotTaxExempt (13LD)']),
    ('corporate_entity_tax_exemp', ['CorporateEntityTaxExempt', 'CorporateEntityTaxExempt (13LE)']),
    ('partnership_or_limited_lia', ['PartnershipOrLimitedLiabilityPartnership',
                                    'PartnershipOrLimitedLiabilityPartnership (13LF)']),
    ('sole_proprietorship', ['SoleProprietorship', 'SoleProprietorship (13LG)']),
    ('small_agricultural_coopera', ['SmallAgriculturalCooperative', 'SmallAgriculturalCooperative (13LH)']),
    ('international_organization', ['InternationalOrganization', 'InternationalOrganization (13LI)']),
    ('us_government_entity', ['U.S.GovernmentEntity', 'U.S.GovernmentEntity (13LJ)']),
    ('community_development_corp', ['CommunityDevelopmentCorporation', 'CommunityDevelopmentCorporation (13TB)']),
    ('domestic_shelter', ['DomesticShelter', 'DomesticShelter (13TD)']),
    ('educational_institution', ['EducationalInstitution', 'EducationalInstitution (13T)']),
    ('foundation', ['Foundation', 'Foundation (13TJ)']),
    ('hospital_flag', ['HospitalFlag', 'HospitalFlag (13VV)']),
    ('manufacturer_of_goods', ['Manufacturer_of_Goods', 'Manufacturer_of_Goods (13TE)']),
    ('veterinary_hospital', ['VeterinaryHospital', 'VeterinaryHospital (13TH)']),
    ('hispanic_servicing_institu', ['HispanicServicingInstitution', 'HispanicServicingInstitution (13TI)']),
    ('contracts', ['Contracts', 'Contracts (13X)']),
    ('grants', ['FederalAssistanceAwards', 'FederalAssistanceAwards (13XA)']),
    ('receives_contracts_and_gra', ['AllAwards', 'AllAwards (13XB)']),
    ('airport_authority', ['AirportAuthority', 'AirportAuthority (13XC)']),
    ('council_of_governments', ['Council_of_Governments', 'Council_of_Governments (13XD)']),
    ('housing_authorities_public', ['HousingAuthoritiesPublic/Tribal', 'HousingAuthoritiesPublic/Tribal (13XE)']),
    ('interstate_entity', ['InterstateEntity', 'InterstateEntity (13XF)']),
    ('planning_commission', ['PlanningCommission', 'PlanningCommission (13XG)']),
    ('port_authority', ['PortAuthority', 'PortAuthority (13XH)']),
    ('transit_authority', ['TransitAuthority', 'TransitAuthority (13XI)']),
    ('subchapter_s_corporation', ['Subchapter_S_Corporation', 'Subchapter_S_Corporation (13XJ)']),
    ('limited_liability_corporat', ['LimitedLiabilityCorporation', 'LimitedLiabilityCorporation (13XK)']),
    ('foreign_owned_and_located', ['ForeignOwned', 'ForeignOwned (13XL)']),
    ('for_profit_organization', ['ForProfitOrganization', 'ForProfitOrganization (13EA)']),
    ('nonprofit_organization', ['NonprofitOrganization', 'NonprofitOrganization (13EE)']),
    ('other_not_for_profit_organ', ['OtherNotForProfitOrganization', 'OtherNotForProfitOrganization (13EF)']),
    ('the_ability_one_program', ['TheAbilityOneProgram', 'TheAbilityOneProgram (13Q)']),
    ('private_university_or_coll', ['Private_University_or_College', 'Private_University_or_College (13SA)']),
    ('state_controlled_instituti', ['StateControlledInstitutionOfHigherLearning',
                                    'StateControlledInstitutionOfHigherLearning (13SC)']),
    ('c1862_land_grant_college', ['1862LandGrantCollege', '1862LandGrantCollege (13RA)']),
    ('c1890_land_grant_college', ['1890LandGrantCollege', '1890LandGrantCollege (13RB)']),
    ('c1994_land_grant_college', ['1994LandGrantCollege', '1994LandGrantCollege (13RC)']),
    ('minority_institution', ['MinorityInstitution', 'MinorityInstitution (13S)']),
    ('historically_black_college', ['HistoricallyBlackCollegeOrUniversity',
                                    'HistoricallyBlackCollegeOrUniversity (13R)']),
    ('tribal_college', ['TribalCollege', 'TribalCollege (13SD)']),
    ('alaskan_native_servicing_i', ['AlaskanNativeServicingInstitution', 'AlaskanNativeServicingInstitution (13SF)']),
    ('native_hawaiian_servicing', ['NativeHawaiianServicingInstitution',
                                   'NativeHawaiianServicingInstitution (13SG)']),
    ('school_of_forestry', ['School_of_Forestry', 'School_of_Forestry (13SB)']),
    ('veterinary_college', ['VeterinaryCollege', 'VeterinaryCollege (13SE)']),
    ('dot_certified_disadvantage', ['DoT_Certified_Disadvantaged_Business_Enterprise',
                                    'DoT_Certified_Disadvantaged_Business_Enterprise (13NB)']),
    ('self_certified_small_disad', ['Self-CertifiedSmallDisadvantagedBusiness',
                                    'Self-CertifiedSmallDisadvantagedBusiness (13NC)']),
    ('small_disadvantaged_busine', ['SmallDisadvantagedBusiness', 'SmallDisadvantagedBusiness (13P)']),
    ('c8a_program_participant', ['8aProgramParticipant', '8aProgramParticipant (13N)']),
    ('historically_underutilized', ['HistoricallyUnderutilizedBusinessZoneHUBZoneFirm',
                                    'HistoricallyUnderutilizedBusinessZoneHUBZoneFirm (13O)']),
    ('sba_certified_8_a_joint_ve', ['SBA_Certified_8_a_Joint_Venture', 'SBA_Certified_8_a_Joint_Venture (13NA)']),
    ('last_modified', ['LastModifiedDate', 'LastModifiedDate (2F)'])
])
db_columns = [key for key in mapping]


def query_data(session, agency_code, agency_type, start, end):
    """ Request D1 file data

        Args:
            session: DB session
            agency_code: FREC or CGAC code for generation
            agency_type: The type of agency (awarding or funding) to generate the file for
            start: Beginning of period for D file
            end: End of period for D file

        Returns:
            The rows using the provided dates for the given agency.
    """
    rows = initial_query(session).\
        filter(func.cast_as_date(file_model.action_date) >= start).\
        filter(func.cast_as_date(file_model.action_date) <= end)

    # Funding or awarding agency filtering
    if agency_type == 'funding':
        rows = rows.filter(file_model.funding_agency_code == agency_code)
    else:
        rows = rows.filter(file_model.awarding_agency_code == agency_code)

    return rows


def initial_query(session):
    return session.query(*[
        file_model.detached_award_proc_unique,
        file_model.unique_award_key,
        file_model.piid,
        file_model.award_modification_amendme,
        file_model.transaction_number,
        file_model.referenced_idv_agency_iden,
        file_model.referenced_idv_agency_desc,
        file_model.parent_award_id,
        file_model.referenced_idv_modificatio,
        file_model.federal_action_obligation,
        file_model.total_obligated_amount,
        file_model.base_exercised_options_val,
        file_model.current_total_value_award,
        file_model.base_and_all_options_value,
        file_model.potential_total_value_awar,
        func.to_char(cast(file_model.action_date, Date), 'YYYYMMDD'),
        func.to_char(cast(file_model.period_of_performance_star, Date), 'YYYYMMDD'),
        func.to_char(cast(file_model.period_of_performance_curr, Date), 'YYYYMMDD'),
        func.to_char(cast(file_model.period_of_perf_potential_e, Date), 'YYYYMMDD'),
        func.to_char(cast(file_model.ordering_period_end_date, Date), 'YYYYMMDD'),
        func.to_char(cast(file_model.solicitation_date, Date), 'YYYYMMDD'),
        file_model.awarding_agency_code,
        file_model.awarding_agency_name,
        file_model.awarding_sub_tier_agency_c,
        file_model.awarding_sub_tier_agency_n,
        file_model.awarding_office_code,
        file_model.awarding_office_name,
        file_model.funding_agency_code,
        file_model.funding_agency_name,
        file_model.funding_sub_tier_agency_co,
        file_model.funding_sub_tier_agency_na,
        file_model.funding_office_code,
        file_model.funding_office_name,
        file_model.foreign_funding,
        file_model.foreign_funding_desc,
        file_model.sam_exception,
        file_model.sam_exception_description,
        file_model.awardee_or_recipient_uei,
        file_model.awardee_or_recipient_legal,
        file_model.vendor_doing_as_business_n,
        file_model.cage_code,
        file_model.ultimate_parent_uei,
        file_model.ultimate_parent_legal_enti,
        file_model.legal_entity_country_code,
        file_model.legal_entity_country_name,
        file_model.legal_entity_address_line1,
        file_model.legal_entity_address_line2,
        file_model.legal_entity_city_name,
        file_model.legal_entity_state_code,
        file_model.legal_entity_state_descrip,
        file_model.legal_entity_zip4,
        file_model.legal_entity_congressional,
        file_model.vendor_phone_number,
        file_model.vendor_fax_number,
        file_model.place_of_perform_city_name,
        file_model.place_of_perform_county_na,
        file_model.place_of_performance_state,
        file_model.place_of_perfor_state_desc,
        file_model.place_of_performance_zip4a,
        file_model.place_of_performance_congr,
        file_model.place_of_perform_country_c,
        file_model.place_of_perf_country_desc,
        file_model.pulled_from,
        file_model.contract_award_type,
        file_model.contract_award_type_desc,
        file_model.idv_type,
        file_model.idv_type_description,
        file_model.multiple_or_single_award_i,
        file_model.multiple_or_single_aw_desc,
        file_model.type_of_idc,
        file_model.type_of_idc_description,
        file_model.type_of_contract_pricing,
        file_model.type_of_contract_pric_desc,
        file_model.award_description,
        file_model.action_type,
        file_model.action_type_description,
        file_model.solicitation_identifier,
        file_model.number_of_actions,
        file_model.inherently_government_func,
        file_model.inherently_government_desc,
        file_model.product_or_service_code,
        file_model.product_or_service_co_desc,
        file_model.contract_bundling,
        file_model.contract_bundling_descrip,
        file_model.dod_claimant_program_code,
        file_model.dod_claimant_prog_cod_desc,
        file_model.naics,
        file_model.naics_description,
        file_model.recovered_materials_sustai,
        file_model.recovered_materials_s_desc,
        file_model.domestic_or_foreign_entity,
        file_model.domestic_or_foreign_e_desc,
        file_model.program_system_or_equipmen,
        file_model.program_system_or_equ_desc,
        file_model.information_technology_com,
        file_model.information_technolog_desc,
        file_model.epa_designated_product,
        file_model.epa_designated_produc_desc,
        file_model.country_of_product_or_serv,
        file_model.country_of_product_or_desc,
        file_model.place_of_manufacture,
        file_model.place_of_manufacture_desc,
        file_model.subcontracting_plan,
        file_model.subcontracting_plan_desc,
        file_model.extent_competed,
        file_model.extent_compete_description,
        file_model.solicitation_procedures,
        file_model.solicitation_procedur_desc,
        file_model.type_set_aside,
        file_model.type_set_aside_description,
        file_model.evaluated_preference,
        file_model.evaluated_preference_desc,
        file_model.research,
        file_model.research_description,
        file_model.fair_opportunity_limited_s,
        file_model.fair_opportunity_limi_desc,
        file_model.other_than_full_and_open_c,
        file_model.other_than_full_and_o_desc,
        file_model.number_of_offers_received,
        file_model.commercial_item_acquisitio,
        file_model.commercial_item_acqui_desc,
        file_model.small_business_competitive,
        file_model.commercial_item_test_progr,
        file_model.commercial_item_test_desc,
        file_model.a_76_fair_act_action,
        file_model.a_76_fair_act_action_desc,
        file_model.fed_biz_opps,
        file_model.fed_biz_opps_description,
        file_model.local_area_set_aside,
        file_model.local_area_set_aside_desc,
        file_model.price_evaluation_adjustmen,
        file_model.clinger_cohen_act_planning,
        file_model.clinger_cohen_act_pla_desc,
        file_model.materials_supplies_article,
        file_model.materials_supplies_descrip,
        file_model.labor_standards,
        file_model.labor_standards_descrip,
        file_model.construction_wage_rate_req,
        file_model.construction_wage_rat_desc,
        file_model.interagency_contracting_au,
        file_model.interagency_contract_desc,
        file_model.other_statutory_authority,
        file_model.additional_reporting,
        file_model.program_acronym,
        file_model.referenced_idv_type,
        file_model.referenced_idv_type_desc,
        file_model.referenced_mult_or_single,
        file_model.referenced_mult_or_si_desc,
        file_model.major_program,
        file_model.national_interest_action,
        file_model.national_interest_desc,
        file_model.cost_or_pricing_data,
        file_model.cost_or_pricing_data_desc,
        file_model.cost_accounting_standards,
        file_model.cost_accounting_stand_desc,
        file_model.government_furnished_prope,
        file_model.government_furnished_desc,
        file_model.sea_transportation,
        file_model.sea_transportation_desc,
        file_model.undefinitized_action,
        file_model.undefinitized_action_desc,
        file_model.consolidated_contract,
        file_model.consolidated_contract_desc,
        file_model.performance_based_service,
        file_model.performance_based_se_desc,
        file_model.multi_year_contract,
        file_model.multi_year_contract_desc,
        file_model.contract_financing,
        file_model.contract_financing_descrip,
        file_model.purchase_card_as_payment_m,
        file_model.purchase_card_as_paym_desc,
        file_model.contingency_humanitarian_o,
        file_model.contingency_humanitar_desc,
        file_model.alaskan_native_owned_corpo,
        file_model.american_indian_owned_busi,
        file_model.indian_tribe_federally_rec,
        file_model.native_hawaiian_owned_busi,
        file_model.tribally_owned_business,
        file_model.veteran_owned_business,
        file_model.service_disabled_veteran_o,
        file_model.woman_owned_business,
        file_model.women_owned_small_business,
        file_model.economically_disadvantaged,
        file_model.joint_venture_women_owned,
        file_model.joint_venture_economically,
        file_model.minority_owned_business,
        file_model.subcontinent_asian_asian_i,
        file_model.asian_pacific_american_own,
        file_model.black_american_owned_busin,
        file_model.hispanic_american_owned_bu,
        file_model.native_american_owned_busi,
        file_model.other_minority_owned_busin,
        file_model.contracting_officers_deter,
        file_model.contracting_officers_desc,
        file_model.emerging_small_business,
        file_model.community_developed_corpor,
        file_model.labor_surplus_area_firm,
        file_model.us_federal_government,
        file_model.federally_funded_research,
        file_model.federal_agency,
        file_model.us_state_government,
        file_model.us_local_government,
        file_model.city_local_government,
        file_model.county_local_government,
        file_model.inter_municipal_local_gove,
        file_model.local_government_owned,
        file_model.municipality_local_governm,
        file_model.school_district_local_gove,
        file_model.township_local_government,
        file_model.us_tribal_government,
        file_model.foreign_government,
        file_model.organizational_type,
        file_model.corporate_entity_not_tax_e,
        file_model.corporate_entity_tax_exemp,
        file_model.partnership_or_limited_lia,
        file_model.sole_proprietorship,
        file_model.small_agricultural_coopera,
        file_model.international_organization,
        file_model.us_government_entity,
        file_model.community_development_corp,
        file_model.domestic_shelter,
        file_model.educational_institution,
        file_model.foundation,
        file_model.hospital_flag,
        file_model.manufacturer_of_goods,
        file_model.veterinary_hospital,
        file_model.hispanic_servicing_institu,
        file_model.contracts,
        file_model.grants,
        file_model.receives_contracts_and_gra,
        file_model.airport_authority,
        file_model.council_of_governments,
        file_model.housing_authorities_public,
        file_model.interstate_entity,
        file_model.planning_commission,
        file_model.port_authority,
        file_model.transit_authority,
        file_model.subchapter_s_corporation,
        file_model.limited_liability_corporat,
        file_model.foreign_owned_and_located,
        file_model.for_profit_organization,
        file_model.nonprofit_organization,
        file_model.other_not_for_profit_organ,
        file_model.the_ability_one_program,
        file_model.private_university_or_coll,
        file_model.state_controlled_instituti,
        file_model.c1862_land_grant_college,
        file_model.c1890_land_grant_college,
        file_model.c1994_land_grant_college,
        file_model.minority_institution,
        file_model.historically_black_college,
        file_model.tribal_college,
        file_model.alaskan_native_servicing_i,
        file_model.native_hawaiian_servicing,
        file_model.school_of_forestry,
        file_model.veterinary_college,
        file_model.dot_certified_disadvantage,
        file_model.self_certified_small_disad,
        file_model.small_disadvantaged_busine,
        file_model.c8a_program_participant,
        file_model.historically_underutilized,
        file_model.sba_certified_8_a_joint_ve,
        func.to_char(cast(file_model.last_modified, Date), 'YYYYMMDD')])
